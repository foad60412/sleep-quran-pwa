<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8">
  <title>قرآن النوم</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <link rel="manifest" href="manifest.json">
  <link rel="icon" href="assets/icons/favicon.ico">
  <link rel="apple-touch-icon" href="assets/icons/icon-192-maskable.png">
  <link rel="stylesheet" href="styles.css">
</head>
<body class="bg-night" data-theme="dark">
  <!-- Splash -->
  <div id="splash" class="splash">
    <div class="splash-logo">
      <svg viewBox="0 0 100 100" class="moon"><circle cx="50" cy="50" r="35" fill="#d4af37"/><circle cx="62" cy="50" r="35" fill="#000"/></svg>
      <div class="splash-title">قرآن النوم</div>
    </div>
  </div>

  <header class="topbar">
    <button id="settingsBtn" class="iconBtn gear" aria-label="الإعدادات">⚙️</button>

    <!-- زر تثبيت على اليمين ويختفي بعد التثبيت -->
    <button id="installBtn" class="installFab right" hidden title="تثبيت"></button>

    <div class="logoWrap">
      <svg class="moon" viewBox="0 0 100 100" aria-hidden="true">
        <circle cx="50" cy="50" r="35" fill="#d4af37"/><circle cx="62" cy="50" r="35" fill="#000"/>
      </svg>
      <div class="appTitle">قرآن النوم</div>
    </div>
  </header>

  <main class="centerWrap">
    <section id="playerCard" class="glass">
      <div class="track-meta">
        <div id="trackTitle">—</div>
        <div id="trackSub">—</div>
      </div>

      <div class="controls">
        <button id="prevBtn" class="btn ico" aria-label="السابق">‹</button>
        <button id="playPauseBtn" class="btn primary circle" aria-label="تشغيل/إيقاف">▶️</button>
        <button id="nextBtn" class="btn ico" aria-label="التالي">›</button>
      </div>

      <div class="progress">
        <span id="currentTime">0:00</span>
        <input id="seek" type="range" min="0" max="100" value="0" aria-label="تحريك موضع التشغيل">
        <span id="duration">0:00</span>
      </div>

      <div class="toggles">
        <label class="row glassRow">
          <div class="rowText"><span class="rowTitle">تكرار المقطع</span><span class="rowHint">يعيد المقطع نفسه</span></div>
          <label class="switch"><input type="checkbox" id="loopTrack"><span class="track"><span class="knob"></span></span></label>
        </label>

        <label class="row glassRow">
          <div class="rowText"><span class="rowTitle">تكرار القائمة</span><span class="rowHint">ينتقل تلقائيًا للعنصر التالي</span></div>
          <label class="switch"><input type="checkbox" id="loopAll" checked><span class="track"><span class="knob"></span></span></label>
        </label>

        <label class="row glassRow">
          <div class="rowText"><span class="rowTitle">مؤقّت النوم</span><span class="rowHint">إيقاف تلقائي</span></div>
          <div class="selectWrap">
            <select id="sleepTimer">
              <option value="0">بدون</option><option value="10">10 دقائق</option>
              <option value="20">20 دقيقة</option><option value="30">30 دقيقة</option>
              <option value="45">45 دقيقة</option><option value="60">60 دقيقة</option>
            </select>
          </div>
        </label>

        <!-- شريط الصوت يظهر على الحاسوب فقط -->
        <label class="row glassRow desktopOnly">
          <div class="rowText"><span class="rowTitle">مستوى الصوت</span><span class="rowHint">تحكم سريع</span></div>
          <input id="volume" type="range" min="0" max="1" step="0.01" value="0.6" class="volRange">
        </label>
      </div>

      <div id="quickActions">
        <button id="playAllBtn" class="btn wide">تشغيل القائمة كاملة</button>
        <button id="stopBtn" class="btn wide outline">إيقاف</button>
      </div>
    </section>

    <!-- قائمة السور (قابلة للطي) -->
    <section class="accordion">
      <button id="togglePlaylist" class="accordionBtn">قائمة السور</button>
      <div id="playlist" class="accordionBody" aria-label="قائمة السور">
        <div id="mulk"    class="item" data-src="audio/Surah-Al-Mulk.small.mp3"    data-title="سورة الملك"   data-sub="الملك"></div>
        <div id="baqarah" class="item" data-src="audio/surah-Albaqarah.small.mp3"  data-title="سورة البقرة"  data-sub="آيات مختارة"></div>
        <div id="ikhlas"  class="item" data-src="audio/surah-Alqrse.small.mp3"     data-title="سورة الإخلاص" data-sub="الإخلاص"></div>
      </div>
    </section>
  </main>

  <!-- نافذة الإعدادات -->
  <div id="settingsModal" class="modal" aria-hidden="true">
    <div class="modalCard">
      <div class="modalHeader">
        <h3>الإعدادات</h3>
        <button id="closeSettings" class="iconBtn">✕</button>
      </div>
      <div class="modalBody">
        <div class="pref">
          <label>الخلفية</label>
          <div class="seg">
            <button class="segBtn" data-bg="night">ليل هادئ</button>
            <button class="segBtn" data-bg="stars">نجوم لامعة</button>
            <button class="segBtn" data-bg="dawn">فجر ذهبي</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- عنصر الصوت -->
  <audio id="audio" preload="auto" playsinline webkit-playsinline></audio>
  <script src="app.js?v=15"></script>
</body>
</html>
